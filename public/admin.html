<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Roy-Hart Climate Survey â€“ Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --purple: #6b46c1;
      --purple-light: #ede9fe;
      --purple-dark: #4c1d95;
      --gray-bg: #f5f5f7;
      --gray-border: #e5e7eb;
      --text-main: #111827;
      --text-muted: #6b7280;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: var(--gray-bg);
      color: var(--text-main);
    }

    header {
      background: var(--purple);
      color: white;
      padding: 16px 24px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    }

    header h1 {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 600;
    }

    main {
      max-width: 1100px;
      margin: 24px auto 48px;
      padding: 0 16px;
    }

    .card {
      background: white;
      border-radius: 12px;
      border: 1px solid var(--gray-border);
      padding: 16px 20px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
    }

    .card h2 {
      margin: 0 0 8px;
      font-size: 1.1rem;
    }

    .card p {
      margin: 0;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .token-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
      align-items: center;
    }

    .token-row input {
      flex: 1 1 220px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--gray-border);
      font-size: 0.95rem;
    }

    .token-row button {
      border: none;
      border-radius: 999px;
      padding: 8px 18px;
      background: var(--purple);
      color: white;
      font-weight: 500;
      font-size: 0.95rem;
      cursor: pointer;
    }

    .token-row button:hover {
      background: var(--purple-dark);
    }

    #status {
      margin-top: 8px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    #status.error {
      color: #b91c1c;
    }

    #status.success {
      color: #047857;
    }

    .summary-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-top: 8px;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .summary-meta span strong {
      color: var(--text-main);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 12px;
      margin-top: 14px;
    }

    .section-card {
      border-radius: 10px;
      border: 1px solid var(--gray-border);
      padding: 10px 12px 12px;
      background: #ffffff;
    }

    .section-title {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .section-subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .question-row {
      margin-top: 4px;
    }

    .question-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 3px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .bar-row {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .bar-track {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: #f3f4f6;
      overflow: hidden;
      display: flex;
    }

    .bar {
      height: 100%;
    }

    .bar-1 { background: #fee2e2; }
    .bar-2 { background: #fed7aa; }
    .bar-3 { background: #fef3c7; }
    .bar-4 { background: #d9f99d; }
    .bar-5 { background: #bbf7d0; }

    .bar-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      min-width: 90px;
      text-align: right;
    }

    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      margin-right: 4px;
      margin-top: 4px;
    }

    /* Free text */
    .free-section {
      padding: 10px 0;
      border-top: 1px solid #f3f4f6;
    }

    .free-header {
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 2px;
    }

    .free-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .free-list {
      margin: 0;
      padding-left: 18px;
      font-size: 0.9rem;
    }

    .free-list li {
      margin-bottom: 3px;
    }

    code {
      font-size: 0.8rem;
      background: #f3f4f6;
      padding: 1px 4px;
      border-radius: 4px;
    }

    @media print {
      header {
        box-shadow: none;
      }
      .token-row {
        display: none;
      }
      #status {
        display: none;
      }
      body {
        background: white;
      }
      main {
        max-width: none;
        margin: 0;
        padding: 0 10mm;
      }
      .card {
        box-shadow: none;
        border-radius: 0;
        border: none;
        border-bottom: 1px solid #e5e7eb;
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Roy-Hart Climate Survey &mdash; Admin</h1>
  </header>

  <main>
    <!-- Token / load -->
    <section class="card">
      <h2>Admin access</h2>
      <p>Enter the admin token (must match <code>ADMIN_TOKEN</code> in Render) to view summary reports.</p>
      <div class="token-row">
        <input
          id="admin-token"
          type="password"
          placeholder="Enter admin token"
          autocomplete="off"
        />
        <button id="load-summary">Load summary</button>
      </div>
      <div id="status"></div>
    </section>

    <!-- Numeric summary -->
    <section id="summary-card" class="card" hidden>
      <h2>Overall Results</h2>
      <div id="summary-meta" class="summary-meta"></div>
      <div id="summary-content"></div>
    </section>

    <!-- Free text -->
    <section id="free-card" class="card" hidden>
      <h2>Open-ended Responses</h2>
      <p>Grouped by question and building. These are exactly as written by families.</p>
      <div id="free-content"></div>
    </section>
  </main>

  <script src="admin.js" defer></script>
</body>
</html>
